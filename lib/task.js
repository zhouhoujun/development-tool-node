"use strict";var path=require("path"),development_tool_1=require("development-tool"),gulp_mocha_1=require("gulp-mocha"),del=require("del"),cache=require("gulp-cached"),ts=require("gulp-typescript"),sourcemaps=require("gulp-sourcemaps"),uglify=require("gulp-uglify"),babel=require("gulp-babel"),nodeDynamicTasks=[{name:"clean",task:function(e){return del(e.getDist())}},{name:"test",oper:development_tool_1.Operation.e2e|development_tool_1.Operation.test,pipe:function(e,t){return e.pipe(gulp_mocha_1.default(t.option.mochaOptions)).once("error",function(){process.exit(1)}).once("end",function(){process.exit()})}}],tsDynamicTasks=[{name:"ts-compile",pipes:function(e){var t=e.option,o=ts.createProject(path.join(e.env.root,t.tsconfig||"./tsconfig.json"));return[function(){return cache("typescript")},sourcemaps.init,o]},output:[function(e,t,o){return e.dts.pipe(o.dest(t.getDist()))},function(e,t,o){var p=t.option;return t.oper===development_tool_1.Operation.release||t.oper===development_tool_1.Operation.deploy?e.js.pipe(babel(p.tsBabelOption||{presets:["es2015"]})).pipe(uglify()).pipe(sourcemaps.write("./sourcemaps")).pipe(o.dest(t.getDist())):e.js.pipe(sourcemaps.write("./sourcemaps")).pipe(o.dest(t.getDist()))}]},{name:"ts-watch",oper:development_tool_1.Operation.build|development_tool_1.Operation.e2e|development_tool_1.Operation.test,watch:["ts-compile"]}];Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={tsDynamicTasks:tsDynamicTasks,nodeDynamicTasks:nodeDynamicTasks};
//# sourceMappingURL=sourcemaps/task.js.map
