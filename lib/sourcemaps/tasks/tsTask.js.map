{"version":3,"sources":["tasks/tsTask.js"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","_typeof","decorate","i","defineProperty","__metadata","k","v","metadata","path","development_core_1","require","cache","ts","sourcemaps","uglify","TsTasks","_classCallCheck","this","_createClass","value","init","config","tsProject","createProject","join","env","root","option","tsconfig","output","tsmap","dt","gulp","dts","pipe","dest","getDist","oper","Operation","release","deploy","js","babel","presets","write","name","build","test","watchTasks","exports"],"mappings":"AAAA,+kBACIA,WAA0C,SAAUC,EAAYC,EAAQC,EAAKC,GAC7E,GAA2HC,GAAvHC,EAAIC,UAAUC,OAAQC,EAAIH,EAAI,EAAIJ,EAAkB,OAATE,EAAgBA,EAAOM,OAAOC,yBAAyBT,EAAQC,GAAOC,CACrH,IAAuB,YAAnB,mBAAOQ,SAAP,YAAAC,QAAOD,WAAoD,kBAArBA,SAAQE,SAAyBL,EAAIG,QAAQE,SAASb,EAAYC,EAAQC,EAAKC,OACpH,KAAK,GAAIW,GAAId,EAAWO,OAAS,EAAGO,GAAK,EAAGA,KAASV,EAAIJ,EAAWc,MAAIN,GAAKH,EAAI,EAAID,EAAEI,GAAKH,EAAI,EAAID,EAAEH,EAAQC,EAAKM,GAAKJ,EAAEH,EAAQC,KAASM,EAChJ,OAAOH,GAAI,GAAKG,GAAKC,OAAOM,eAAed,EAAQC,EAAKM,GAAIA,GAE5DQ,WAA0C,SAAUC,EAAGC,GANvDnB,GAAc,YAAdA,mBAAAA,SAAAA,YAAAA,QAAAA,WAAoDC,kBAAzBD,SAAeoB,SAAsBlB,MAAQC,SAA9BiB,SAAyCF,EAAAC,IACnFE,KAA8Bf,QAAQJ,QAAtCoB,mBAAAC,QAAA,oBACAC,MAAID,QAAOX,eAC2Ca,GAAAF,QAAQtB,mBAC9DyB,WAAOH,QAAcb,mBAJzBiB,OAAAJ,QAAA,eAMIN,MAAAA,QAAc,cACdW,QAAAA,WAAA,QAAAA,KAAAC,gBAAAC,KAAAF,GAAA,MAAAG,cAAAH,IAAAzB,IAAA,QAAA6B,MAAA,WAEEX,QAEQE,KAAQ,aACXA,OACQA,WAAAA,MAAQC,OAAA,eACZD,WAAQU,KACD,SAAAC,GAClBN,GAAAA,GAAAA,EAAAA,OAAAO,EAAAV,GAAAW,cAAAf,KAAAgB,KAAAH,EAAAI,IAAAC,MAAA,GAAAC,EAAAC,UAAA,mBAAA,OAAAN,OAAAO,QAAA,SAAAC,EAAAT,EAAAU,EAAAC,GAAA,MAAAF,GAAAG,IAAAC,KAAAF,EAAAG,KAAAd,EAAAe,QAAAL,MAAA,SAAAD,EACQT,EAAAU,EAAAC,GAEA,MAAAX,GAAAgB,OAAA5B,mBAAA6B,UAAAC,SAAAlB,EAAAgB,OAAA5B,mBAAA6B,UAAAE,OAAAV,EAAAW,GAAAP,KAAAQ,OAAAC,SAAA,aAGYT,KAAApB,UAAAoB,KAAArB,WAAA+B,MAAA,iBAAYV,KAAAF,EAAAG,KAAZd,EAAAe,QAAAL,KAIIT,EAAeC,GAAAA,KAAAA,WAAmBC,MAAKH,iBAAmBa,KAAIP,EAAOC,KAAAA,EAAYQ,QAAAL,SAOrFc,KAAA,WACIR,KAAA5B,mBAAgByB,UAAWY,MAAEH,mBACxBT,UAAKpB,IAAUoB,mBAAKI,UAAiBS,KAE7CC,YACI,oBA/BzBjC,IAsCY8B,SAAAA,YACAR,mBAAM5B,aACNuC,MAAAA,OAGX5C,WAAA,yBAlCDW,SA0CJkC,QAAQlC,QAAUA","file":"../../tasks/tsTask.js","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nconst path = require('path');\nconst development_core_1 = require('development-core');\nconst cache = require('gulp-cached');\nconst ts = require('gulp-typescript');\nconst sourcemaps = require('gulp-sourcemaps');\nconst uglify = require('gulp-uglify');\nconst babel = require('gulp-babel');\nlet TsTasks = class TsTasks {\n    tasks() {\n        return [\n            {\n                name: 'ts-compile',\n                pipes: [\n                        () => cache('typescript'),\n                    sourcemaps.init,\n                        (config) => {\n                        let option = config.option;\n                        let tsProject = ts.createProject(path.join(config.env.root || '', option.tsconfig || './tsconfig.json'));\n                        return tsProject();\n                    }\n                ],\n                output: [\n                        (tsmap, config, dt, gulp) => tsmap.dts.pipe(gulp.dest(config.getDist(dt))),\n                        (tsmap, config, dt, gulp) => {\n                        if (config.oper === development_core_1.Operation.release || config.oper === development_core_1.Operation.deploy) {\n                            return tsmap.js.pipe(babel({ presets: ['es2015'] }))\n                                .pipe(uglify()).pipe(sourcemaps.write('./sourcemaps'))\n                                .pipe(gulp.dest(config.getDist(dt)));\n                        }\n                        else {\n                            return tsmap.js.pipe(sourcemaps.write('./sourcemaps')).pipe(gulp.dest(config.getDist(dt)));\n                        }\n                    }\n                ]\n            },\n            {\n                name: 'ts-watch',\n                oper: development_core_1.Operation.build | development_core_1.Operation.e2e | development_core_1.Operation.test,\n                watchTasks: ['ts-compile']\n            }\n        ];\n    }\n};\nTsTasks = __decorate([\n    development_core_1.dynamicTask({\n        group: 'ts'\n    }), \n    __metadata('design:paramtypes', [])\n], TsTasks);\nexports.TsTasks = TsTasks;\n"]}